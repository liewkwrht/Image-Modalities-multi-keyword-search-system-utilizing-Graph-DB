<!-- search.html -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neo4j Search</title>

    <!-- Include the Select2 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

    <!-- Include jQuery (required for Select2) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Include the Select2 JavaScript -->
    <script 
    src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <style>
        /* Adjust the width of the dropdown container */
    /* Adjust the width of the dropdown container */
    #symptoms {
        width: 300px; /* Adjust the width as needed */
    }
</style>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<script>
    $(document).ready(function() {
        // Initialize Select2 for symptoms and targetClasses dropdowns
        $('#symptoms, #targetClasses').select2({
            multiple: true,
            tags: true,
            tokenSeparators: [','],
            placeholder: 'Select...'
        });
    
        // Preselect the targetClasses dropdown with the provided values
        const targetClassesValues = ["X_ray", "CT", "MRI", "DSI", "US"];
        $('#targetClasses').val(targetClassesValues).trigger('change');
    
        // Function to handle the form submission and make an API call
        $('#searchForm').on('submit', function(event) {
            event.preventDefault(); // Prevent the default form submission
            console.log($('#symptoms').val()); // Should log an array of selected symptom values
            console.log($('#targetClasses').val()); // Should log an array of selected target class values
            
            // Get values from form fields
            const name = $('#name').val();
            const id = $('#id').val();
            const disease = $('#disease').val();
            const bodyPart = $('#bodypart').val();
            const symptoms = $('#symptoms').val() || []; // Using jQuery for Select2
            const targetClasses = $('#targetClasses').val() || []; // Using jQuery for Select2
    
            // Construct the search data object
            let searchData = {
                name: name,
                patient_id: id ? parseInt(id) : undefined,
                bodypart: bodyPart !== 'null' ? bodyPart : undefined,
                disease: disease !== 'null' ? disease : undefined,
                symptoms: symptoms,
                targetClasses: targetClasses
            };
    
            // Filter out empty strings and null values
            searchData = Object.fromEntries(Object.entries(searchData).filter(([_, v]) => v != null && v !== ''));
    
            // Redirect to result page with query parameters
            const searchParams = new URLSearchParams(searchData).toString();
            window.location.href = `result.html?${searchParams}`;
        });
    });
    </script>
    
    
</head>
<body>
    <h1>Neo4j Search</h1>
    <form id="searchForm" action="result.html" method="GET">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" placeholder="Enter Name">
        <br><br>

        <label for="id">ID:</label>
        <input type="text" id="id" name="patient_id" placeholder="Enter ID">
        <br><br>

        <label for="bodypart">Body Part:</label>
        <select id="bodypart" name = "bodypart">
        <!-- Add more body part options as needed -->
            <option value="null">Don't select</option> 
            <option value="breast">Breast</option>
            <option value="wrist">Wrist</option>
            <option value="herniated_disc">Herniated Disc</option>
            <option value="stomach">Stomach</option>
            <option value="ovaries">Ovaries</option>
            <option value="shoulder">Shoulder</option>
            <option value="esophagus">Esophagus</option>
            <option value="brain">Brain</option>
            <option value="lung">Lung</option>
            <option value="knee">Knee</option>
            <option value="leg">Leg</option>
            <option value="arm">Arm</option>
            <option value="Head">Head</option>
            <option value="blood_system">Blood System</option>
            <option value="heart">Heart</option>
            <option value="thyroid">Thyroid</option>
            <option value="testicles">Testicles</option>
            <option value="bladder">Bladder</option>
            <option value="kidney">Kidney</option>
            <option value="Liver">Liver</option>

            <!-- Add more body part options as needed -->
        </select>
        <br><br>

        <label for="symptoms">Symptoms:</label>
        <select id="symptoms" name="symptoms" multiple="multiple">
            <option value="null">Don't select</option>
            <option value="pain">Pain</option>
            <option value="bone_protruding">Bone Protruding</option>
            <option value="ache_pain">Ache Pain</option>
            <option value="neurological">Neurological</option>
            <option value="fatigue">Fatigue</option>
            <option value="headache">Headache</option>
            <option value="breathing_difficulties">Breathing Difficulties</option>
            <option value="skin_changes">Skin Changes</option>
            <option value="nausea">Nausea</option>
            <option value="changes_in_urination">Changes in Urination</option>
            <option value="changes_in_vision">Changes in Vision</option>
            <option value="fever">Fever</option>
            <option value="swelling">Swelling</option>
            <option value="limited_mobility">Limited Mobility</option>
            <option value="cough">Cough</option>
            <option value="vomiting">Vomiting</option>
            <option value="blood_in_your_urine">Blood in Your Urine</option>
            <option value="problems_with_movement">Problems with Movement</option>
            <option value="speech_difficulty">Speech Difficulty</option>
            <option value="Head_Truama">Head Trauma</option>
            <option value="Dizziness">Dizziness</option>
        </select>

        <label for="disease">Disease:</label>
        <select id="disease" name="disease">
            <option value="" selected disabled>Select a disease</option>
            <option value="cancer">Cancer</option>
            <option value="bone_fractures">Bone Fractures</option>
            <option value="pneumonia">Pneumonia</option>
            <option value="kidney_stones">Kidney Stones</option>
            <option value="Head_Trauma">Head Trauma</option>
            <option value="osteoarthritis">Osteoarthritis</option>
            <option value="spinal_disc_herniation">Spinal Disc Herniation</option>
            <option value="osteoporosis">Osteoporosis</option>
            <option value="tuberculosis">Tuberculosis</option>
            <option value="traumatic_injuries">Traumatic Injuries</option>
            <option value="appendicitis">Appendicitis</option>
            <option value="blood_clots">Blood Clots</option>
            <option value="abdominal_tumors">Abdominal Tumors</option>
            <option value="spinal_cord_injuries">Spinal Cord Injuries</option>
            <option value="stroke">Stroke</option>
            <option value="joint_injuries">Joint Injuries</option>
        </select>
        <br><br>

        <label for="targetClasses">Target Classes:</label>
        <select id="targetClasses" name="targetClasses" multiple="multiple">
            <option value="X_ray">X-ray</option>
            <option value="CT">CT</option>
            <option value="MRI">MRI</option>
            <option value="DSI">DSI</option>
            <option value="US">US</option>
            <!-- Add more target class options as needed -->
        </select>
            <!-- Add more symptom options as needed -->
            <button type="submit">Search Neo4j</button>
        <script>
            // Initialize Select2 on the symptoms dropdown
            $(document).ready(function() {
                $('#symptoms').select2({
                    multiple: true,
                    tags: true,
                    tokenSeparators: [','],
                    placeholder: 'Select symptoms'
                });
            });
            const targetClassesValues = ["X_ray", "CT", "MRI", "DSI", "US"];
            $('#targetClasses').val(targetClassesValues).trigger('change');


    // Function to handle the form submission and make an API call
$('#searchForm').on('submit', function(event) {
        // Prevent the default form submission if you handle the form data with JavaScript
    event.preventDefault();
    console.log($('#symptoms').val()); // Should log an array of selected symptom values
    console.log($('#targetClasses').val());
    // Get values from form fields
    const name = document.getElementById('name').value;
    const id = document.getElementById('id').value;
    const disease = document.getElementById('disease').value;
    const bodyPart = document.getElementById('body_part').value;
    const symptoms = $('#symptoms').val() || []; // Using jQuery for Select2
    const targetClasses = $('#targetClasses').val() || []; // Using jQuery for Select2

    // Construct the search data object
    let searchData = {
        name: name,
        patient_id: id ? parseInt(id) : undefined,
        bodypart: bodyPart !== "" ? bodyPart : undefined,
        disease: disease !== "" ? disease : undefined,
        symptoms: symptoms,
        targetClasses: targetClasses
    };

    // Filter out empty strings and null values
    searchData = Object.fromEntries(Object.entries(searchData).filter(([_, v]) => v != null && v !== ''));

    // Redirect to result page with query parameters
    const searchParams = new URLSearchParams(searchData).toString();
    window.location.href = `result.html?${searchParams}`;
})
,
document.getElementById('searchForm').addEventListener('submit', searchNeo4j)
